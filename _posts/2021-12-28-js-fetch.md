---
title: "JS - fetch"
date: 2021-12-28
comments: true
read_time: false
toc: true
categories:
  - JS
tags:
  - fetch
---

10ì›” ë§ì— ë‹¤ì¹˜ê³  ë¶€í„° ìƒí™œíŒ¨í„´ì´ ê¼¬ì´ë”ë‹ˆ ìˆœì‹ê°„ì— 2ë‹¬ ê°€ëŸ‰ íë¥¸ê±° ê°™ë‹¤. ~~ê·¸ëƒ¥ ê²Œì„ëŸ¬ì¡Œë‹¤..~~ ğŸ„  
ì—°ë§ì´ ë˜ë‹ˆ ë²ˆëœ© ì •ì‹ ì´ ë“¤ë”ë¼.. ã…ã…; ğŸ’¦

`fetch API` ì— ëŒ€í•´ ë©”ëª¨í•˜ë ¤ í•œë‹¤.

## fetch API

ë¹„ë™ê¸° í™˜ê²½ì—ì„œ ë¹„ë™ê¸°ë¡œ í†µì‹ í•˜ì—¬ í†µì‹ ì— ì„±ê³µí•  ê²½ìš° `Promise` ê°ì²´ë¥¼ ë°˜í™˜í•˜ëŠ” `API` ì´ë‹¤. `XHLHttpRequest` ì™€ ë¹„ìŠ·í•˜ì§€ë§Œ `CORS, HTTP` ê´€ë ¨í•˜ì—¬ ë” ë§ì€ ì§€ì›ì„ í•˜ê³  ìˆë‹¤.  
ë¹„ë™ê¸° í™˜ê²½ì—ì„œ ì‹¤í–‰ë˜ë¯€ë¡œ `async/await` ì™€ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```js
// ì¶œì²˜: https://developer.mozilla.org/ko/docs/Web/API/Fetch_API/Using_Fetch

fetch("https://example.com/profile/avatar", {
  method: "PUT",
  body: formData,
})
  .then((response) => response.json())
  .catch((error) => console.error("Error:", error))
  .then((response) => console.log("Success:", JSON.stringify(response)));
```

## êµ¬ì„±

`HTTP Request, Response, Headers, Body` ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©°, ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ì§€ ì•Šê³  ì§ì ‘ í˜¸ì¶œí•˜ì—¬ ì‚¬ìš©í•˜ê³  Service Worker ì™€ ê°™ì€ APIì—ì„œë„ ì“¸ ìˆ˜ ìˆë‹¤.

`fetch(url, options)`

### Request

- R/W : ì‘ì„± ê°€ëŠ¥ ì—¬ë¶€ **W**ë§Œ ì‘ì„± ê°€ëŠ¥

|       í”„ë¡œí¼í‹°        |                         ê°œìš”                         | R/W |
| :-------------------: | :--------------------------------------------------: | :-: |
|        `body`         |           ë¬¸ìì—´, FormData, Blob ë“± ë°ì´í„°           |  W  |
|        `cache`        |                 Requestì˜ cache ëª¨ë“œ                 |  W  |
|     `credentials`     |            Requestì˜ ì¸ì¦ì •ë³´, ì¿ í‚¤ ê´€ë ¨             |  W  |
|     `destination`     |         Request ë¦¬ì†ŒìŠ¤ íƒ€ì… (image, worker)          |  R  |
|       `headers`       |                Request Headers Object                |  W  |
|      `integrity`      | ì„œë¸Œ ë¦¬ì†ŒìŠ¤ ì •í•©ì„± ê°’(ë¸Œë¼ìš°ì €ê°€ ì²´í¬í•˜ëŠ” ë³´ì•ˆ ê¸°ëŠ¥) |  W  |
| `isReloadNavigation`  |            ë¦¬ë¡œë“œ ë„¤ë¹„ê²Œì´ì…˜ Request ì—¬ë¶€            |  R  |
| `isHistoryNavigation` |           íˆìŠ¤í† ë¦¬ ë„¤ë¹„ê²Œì´ì…˜ Request ì—¬ë¶€           |  R  |
|       `method`        |                    Request method                    |  W  |
|      `keepalive`      |         ì›¹í˜ì´ì§€ë³´ë‹¤ Request ê°€ ë” ì˜¤ë˜ ì¡´ì†         |  W  |
|        `mode`         |                 Request Mode (cors)                  |  W  |
|      `redirect`       |                 ë¦¬ë‹¤ì´ë ‰íŠ¸ ì·¨ê¸‰ ë°©ë²•                 |  W  |
|      `referrer`       |          í˜„ì¬ í˜ì´ì§€ë¥¼ ë§í¬í•­ ì´ì „ Address           |  W  |
|   `referrerPolicy`    |            Requestì— reffer ì •ë³´í¬í•¨ ê¸°ì¤€            |  W  |
|       `signal`        |                   AbortSignal ì œì–´                   |  W  |

### Response

new Response ë¥¼ í†µí•´ ë§Œë“¤ ìˆ˜ ìˆì§€ë§Œ fetch ê°€ ëë‚˜ë©´ ë°˜í™˜ëœë‹¤.

|   í”„ë¡œí¼í‹°   |           ê°œìš”           |
| :----------: | :----------------------: |
|   `error`    |        í†µì‹  ì—ëŸ¬         |
|  `headers`   |     Response header      |
|     `ok`     |     Status 200 - 299     |
|  `redirect`  |     ë¦¬ë‹¤ì´ë ‰íŠ¸ ì—¬ë¶€      |
| `redirected` | ë¦¬ë‹¤ì´ë ‰íŠ¸ url ë‹¤ìˆ˜ ì—¬ë¶€ |
|   `status`   |        ìƒíƒœ ì½”ë“œ         |
| `statusText` |     ìƒíƒœ ì½”ë“œ ë©”ì„¸ì§€     |
|    `type`    |        ì‘ë‹µ íƒ€ì…         |
|    `url`     |         ì‘ë‹µ URL         |

### Body

`Mixin` ìœ¼ë¡œ Request ì™€ Response ê°€ ìƒì†ë°›ìœ¼ë©°, `bodyUsed` ê°€ `true` ì¸ ê²½ìš° **body ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.**

|     ë©”ì†Œë“œ      |                   ê°œìš”                    |
| :-------------: | :---------------------------------------: |
|     `body`      | ReadableStrem ê°ì²´ (ë°ì´í„° ìŠ¤íŠ¸ë¦¼ì„ í¬í•¨) |
|   `bodyUsed`    |               body ì‚¬ìš©ì—¬ë¶€               |
| `arrayBuffer()` |            í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜             |
|    `blob()`     |            í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜             |
|  `formData()`   |            í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜             |
|    `json()`     |           JSON.parse ê²°ê³¼ ë°˜í™˜            |
|    `text()`     |        UTF-8ë¡œ ì¸ì½”ë”©í•œ ê²°ê³¼ ë°˜í™˜         |

### Headers

ì†ì„±ì€ ëŒ€ì†Œë¬¸ìë¥¼ ë³´í¸ì ìœ¼ë¡œ êµ¬ë³„í•˜ì§€ ì•Šì§€ë§Œ êµ¬ë³„í•˜ëŠ” ê²ƒë„ ìˆìœ¼ë¯€ë¡œ êµ¬ë¶„í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

|   ë©”ì†Œë“œ   |        ê°œìš”         |
| :--------: | :-----------------: |
| `append()` |  ìƒˆë¡œìš´ í—¤ë” ì¶”ê°€   |
| `delete()` |      í•´ë” ì‚­ì œ      |
|  `get()`   |       ê°’ ë°˜í™˜       |
|  `set()`   | ë³€ê²½ ë° ì—†ìœ¼ë©´ ì¶”ê°€ |
|  `has()`   |      í¬í•¨ì—¬ë¶€       |

```js
async function getImage(url) {
  const requestPayload = new Request(url, {
    method: "GET",
    headers: {
      "Content-Type": "image/jpeg",
      Accept: "image/jpeg",
    },
  });

  const response = await fetch(requestPayload);
  return response?.blob();
}

getImage().then((blob) => {
  const img = document.createElement("img");
  img.src = URL.createObjectURL(blob);
  document.body.appendChild(img);
});
```

## ì°¸ê³ ìë£Œ

- [ì¸í”„ëŸ° - ìë°”ìŠ¤í¬ë¦½íŠ¸ ES6+ì‹¬í™”](https://www.inflearn.com/course/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-es6-%EC%8B%AC%ED%99%94)
- [Fetch - Living Standard](https://fetch.spec.whatwg.org/)
- [Fetch API - MDN](https://developer.mozilla.org/ko/docs/Web/API/Fetch_API)

<hr/>

_ê°œì¸ì´ ì°¸ê³ í•˜ê³ ì ì‘ì„±í•œ ê¸€ì´ë©°, ì˜ëª»ëœ ì •ë³´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ëª»ëœ ì •ë³´ëŠ” ë©”ì¼ë¡œ ë³´ë‚´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤._ ğŸ™
